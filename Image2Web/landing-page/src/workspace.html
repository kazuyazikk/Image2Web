<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description"
    content="Your personal workspace on Image2Web. Manage your projects and conversions here. Designed by SeroTech.">
  <title>IMAGE2WEB - Your Workspace</title>
  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Poppins:wght@300;400;500;600;700;800&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <style>
    /* Mobile-first responsive styles */
    body {
      opacity: 0;
      transition: opacity 0.5s ease-in-out;
    }

    body.loaded {
      opacity: 1;
    }

    /* Image2CodeAI Style Workspace Layout */
    .main-wrapper {
      display: flex;
      flex-direction: column;
      width: 100%;
      max-width: 100%;
      margin: 0;
      padding: 10px 0;
    }

    .sidebar {
      width: 100%;
      background: rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(10px);
      padding: 10px 15px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.15);
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      gap: 10px;
      order: 2;
    }

    .sidebar-nav ul {
      list-style: none;
      padding: 0;
      margin: 0;
      display: flex;
      flex-direction: row;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: center;
    }

    .sidebar-nav li a,
    .logout-btn {
      display: block;
      padding: 6px 10px;
      color: var(--text-secondary);
      text-decoration: none;
      border-radius: 5px;
      transition: background 0.2s ease, color 0.2s ease;
      font-size: 0.85em;
      white-space: nowrap;
    }

    .sidebar-nav li a:hover,
    .logout-btn:hover {
      background: rgba(56, 189, 248, 0.1);
      color: var(--secondary-blue);
    }

    .sidebar-nav li.active a {
      background: linear-gradient(135deg, var(--secondary-blue), var(--primary-blue));
      color: var(--text-primary);
      font-weight: bold;
    }

    .sidebar-user {
      padding-top: 10px;
      border-top: 1px solid rgba(255, 255, 255, 0.15);
      margin-top: 10px;
      text-align: center;
    }

    .sidebar-user p {
      color: var(--text-primary);
      margin-bottom: 6px;
      font-weight: bold;
      font-size: 0.85em;
    }

    .logout-btn {
      background: transparent;
      border: 1px solid var(--glass-border);
      color: var(--text-secondary);
      cursor: pointer;
      width: 100%;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }

    .main-content-area {
      flex-grow: 1;
      padding: 20px;
      background: transparent;
      order: 1;
      display: flex;
      flex-direction: row;
      gap: 20px;
      height: calc(100vh - 120px);
    }

    /* Two Column Layout */
    .workspace-left-column {
      flex: 0 0 350px;
      min-width: 300px;
      display: flex;
      flex-direction: column;
    }

    .workspace-right-column {
      flex: 1;
      display: flex;
      flex-direction: column;
      background: rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.15);
      border-radius: 12px;
      overflow: hidden;
    }

    /* Input Section */
    .input-section {
      padding: 30px;
      background: rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.15);
      border-radius: 12px;
      height: 100%;
    }

    .workspace-title {
      font-family: 'Poppins', sans-serif;
      font-size: 2.5rem;
      font-weight: 700;
      color: var(--text-primary);
      margin: 0 0 30px 0;
      line-height: 1.2;
    }


    .action-buttons {
      display: flex;
      gap: 12px;
      margin-bottom: 20px;
    }

    .add-images-btn {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 12px 20px;
      background: transparent;
      border: 2px solid var(--glass-border);
      color: var(--text-secondary);
      border-radius: 8px;
      font-size: 0.9rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Inter', sans-serif;
    }

    .add-images-btn:hover {
      background: rgba(56, 189, 248, 0.1);
      border-color: var(--secondary-blue);
      color: var(--secondary-blue);
    }

    .generate-btn {
      padding: 12px 24px;
      background: linear-gradient(135deg, var(--secondary-blue), var(--primary-blue));
      color: var(--text-primary);
      border: none;
      border-radius: 8px;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Inter', sans-serif;
    }

    .generate-btn:hover {
      background: linear-gradient(135deg, var(--primary-blue), var(--tertiary-blue));
      transform: translateY(-2px);
    }

    /* Image Upload Area */
    .image-upload-area {
      display: flex;
      flex-direction: column;
      align-items: center;
      border: 2px dashed var(--secondary-blue);
      border-radius: 8px;
      padding: 20px;
      text-align: center;
      min-height: 120px;
      justify-content: center;
      transition: background-color 0.3s ease, border-color 0.3s ease;
      margin-bottom: 20px;
    }

    .image-upload-area.drag-over {
      background-color: rgba(56, 189, 248, 0.1);
      border-color: var(--primary-blue);
    }

    .upload-label {
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 16px;
      background: linear-gradient(135deg, var(--secondary-blue), var(--primary-blue));
      color: var(--text-primary);
      border-radius: 8px;
      font-weight: 600;
      transition: background 0.3s ease, transform 0.2s ease;
      font-size: 0.9em;
    }

    .upload-label:hover {
      background: linear-gradient(135deg, var(--primary-blue), var(--tertiary-blue));
      transform: translateY(-2px);
    }

    #imagePreview {
      max-width: 100%;
      max-height: 150px;
      border-radius: 8px;
      margin-top: 1rem;
      object-fit: contain;
      border: 1px solid rgba(255, 255, 255, 0.15);
      display: none;
    }

    #fileName {
      margin-top: 10px;
      font-size: 0.9em;
      color: #cbd5e1;
      word-break: break-all;
    }

    .remove-image-btn {
      background: linear-gradient(135deg, #ef4444, #dc2626);
      color: #f8fafc;
      border: none;
      padding: 8px 16px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Inter', sans-serif;
      margin-top: 10px;
    }

    .status-message {
      margin-top: 15px;
      font-size: 0.9em;
      text-align: left;
      min-height: 20px;
      color: #cbd5e1;
    }

    /* Output Section */
    .output-section {
      height: 100%;
      display: flex;
      flex-direction: column;
    }

    .output-tabs {
      display: flex;
      background: rgba(255, 255, 255, 0.05);
      border-bottom: 1px solid rgba(255, 255, 255, 0.15);
    }

    .tab-btn {
      flex: 1;
      padding: 16px 20px;
      background: transparent;
      border: none;
      color: var(--text-secondary);
      font-size: 0.9rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Inter', sans-serif;
    }

    .tab-btn.active {
      background: var(--glass-bg);
      color: var(--text-primary);
    }

    .tab-btn:hover:not(.active) {
      background: rgba(255, 255, 255, 0.05);
      color: var(--text-secondary);
    }

    .save-zip-btn {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 12px 16px;
      background: linear-gradient(135deg, var(--secondary-blue), var(--primary-blue));
      border: none;
      color: var(--text-primary);
      border-radius: 8px;
      font-size: 0.8rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Inter', sans-serif;
      margin-left: 8px;
    }

    .save-zip-btn:hover {
      background: linear-gradient(135deg, var(--primary-blue), var(--tertiary-blue));
      transform: translateY(-2px);
    }

    .output-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    .tab-content {
      display: none;
      flex: 1;
      padding: 20px;
      height: 100%;
    }

    .tab-content.active {
      display: flex;
    }

    #preview-tab {
      padding: 0;
      height: 100%;
      flex-direction: column;
    }

    #inspector-preview {
      width: 100%;
      height: 100%;
      border: none;
      background: #f8fafc;
      flex: 1;
      min-height: 0;
    }

    .code-editors {
      display: flex;
      flex-direction: row;
      gap: 15px;
      height: 100%;
      width: 100%;
    }

    .code-editor-section {
      flex: 1 1 50%;
      display: flex;
      flex-direction: column;
      min-width: 0;
      width: 100%;
    }

    .code-editor-section h4 {
      color: #f8fafc;
      font-size: 0.9rem;
      font-weight: 600;
      margin: 0 0 10px 0;
      font-family: 'Inter', sans-serif;
    }

    .code-editor {
      flex: 1;
      width: 100%;
      min-width: 0;
      padding: 20px;
      background: var(--input-bg);
      color: var(--text-primary);
      border: 1px solid var(--glass-border);
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      font-size: 0.9rem;
      line-height: 1.5;
      resize: none;
      outline: none;
      white-space: pre-wrap;
      word-wrap: break-word;
      overflow-wrap: break-word;
      box-sizing: border-box;
    }

    .code-editor:focus {
      border-color: var(--secondary-blue);
    }

    .save-btn {
      margin-top: 10px;
      padding: 8px 16px;
      background: linear-gradient(135deg, var(--secondary-blue), var(--primary-blue));
      color: var(--text-primary);
      border: none;
      border-radius: 6px;
      font-size: 0.8rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Inter', sans-serif;
      align-self: flex-start;
    }

    .save-btn:hover {
      background: linear-gradient(135deg, var(--primary-blue), var(--tertiary-blue));
      transform: translateY(-1px);
    }

    /* Mobile hamburger menu */
    #nav-toggle {
      display: block;
      background: none;
      border: none;
      color: #38bdf8;
      font-size: 1.8em;
      cursor: pointer;
      z-index: 1003;
      position: absolute;
      top: 15px;
      right: 15px;
      padding: 5px;
      transition: transform 0.3s ease;
    }

    /* Hide burger button on desktop */
    @media (min-width: 1024px) {
      #nav-toggle {
        display: none;
      }
    }

    /* Tablet styles */
    @media (min-width: 768px) {
      .main-wrapper {
        flex-direction: row;
        padding-top: 20px;
      }
      
      .sidebar {
        width: 200px;
        min-width: 200px;
        border-right: 1px solid rgba(255, 255, 255, 0.15);
        border-bottom: none;
        border-radius: 10px 0 0 10px;
        order: 1;
      }
      
      .sidebar-nav ul {
        flex-direction: column;
      }
      
      .main-content-area {
        padding: 20px;
        border-radius: 0 10px 10px 0;
        order: 2;
        flex-direction: row;
        height: calc(100vh - 140px);
      }

      .workspace-left-column {
        flex: 0 0 320px;
        min-width: 280px;
      }

      .workspace-right-column {
        flex: 1;
      }
    }

    /* Desktop styles */
    @media (min-width: 1024px) {
      .sidebar {
        width: 250px;
      }

      .main-content-area {
        padding: 20px;
      }

      .workspace-left-column {
        flex: 0 0 380px;
        min-width: 350px;
      }

      .workspace-title {
        font-size: 3rem;
      }
    }

    /* Tablet styles */
    @media (max-width: 1023px) and (min-width: 768px) {
      .code-editors {
        flex-direction: row;
        gap: 12px;
        width: 100%;
      }

      .code-editor-section {
        flex: 1 1 50%;
        width: 100%;
      }

      .code-editor {
        font-size: 0.85rem;
        padding: 18px;
      }
    }

    /* Mobile styles */
    @media (max-width: 767px) {
      .main-wrapper {
        padding: 10px 0;
      }

      .main-content-area {
        flex-direction: column;
        height: auto;
        padding: 15px;
      }

      .workspace-left-column {
        flex: none;
        min-width: auto;
        margin-bottom: 20px;
      }

      .workspace-right-column {
        min-height: 500px;
        flex: 1;
      }

      .code-editors {
        flex-direction: column;
        gap: 15px;
        width: 100%;
      }

      .code-editor {
        font-size: 0.8rem;
        padding: 15px;
      }

      .workspace-title {
        font-size: 2rem;
      }

      .input-section {
        padding: 20px;
      }

      .action-buttons {
        flex-direction: column;
      }

      .add-images-btn,
      .generate-btn {
        width: 100%;
        justify-content: center;
      }
    }

    /* Large desktop styles */
    @media (min-width: 1200px) {
      #inspector-preview {
        height: 100%;
        min-height: 70vh;
      }

      .code-pane textarea, .css-pane textarea {
        min-height: 300px;
      }
    }

    /* Loading spinner */
    #loading-spinner {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      z-index: 2000;
      align-items: center;
      justify-content: center;
      background: rgba(0, 0, 0, 0.5);
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>

<body>
  <header>
    <div class="header-content">
      <div class="logo">
        <svg width="56" height="56" viewBox="0 0 56 56" fill="none" xmlns="http://www.w3.org/2000/svg" aria-label="CODE4WEB logo">
          <defs>
            <linearGradient id="c4w-blue" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0%" stop-color="#38BDF8"/>
              <stop offset="100%" stop-color="#0EA5E9"/>
            </linearGradient>
            <linearGradient id="c4w-violet" x1="1" y1="0" x2="0" y2="1">
              <stop offset="0%" stop-color="#A78BFA"/>
              <stop offset="100%" stop-color="#FB7185"/>
            </linearGradient>
          </defs>
          <rect x="0.5" y="0.5" width="55" height="55" rx="12" fill="#0b1025"/>
          <circle cx="28" cy="28" r="25" fill="url(#c4w-blue)" opacity="0.06"/>
          <circle cx="28" cy="28" r="25" stroke="url(#c4w-violet)" stroke-width="1.5" opacity="0.6"/>
          <path d="M21 18 L13 28 L21 38" stroke="url(#c4w-blue)" stroke-width="3.5" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M35 18 L43 28 L35 38" stroke="url(#c4w-violet)" stroke-width="3.5" stroke-linecap="round" stroke-linejoin="round"/>
          <rect x="24" y="24" width="8" height="8" rx="2" fill="url(#c4w-blue)" opacity="0.95"/>
          <rect x="24" y="24" width="8" height="8" rx="2" fill="url(#c4w-violet)" opacity="0.35"/>
        </svg>
        <div>
          <span class="brand">IMAGE2WEB</span>
          <div class="slogan">Building Tomorrow's Digital Experience</div>
        </div>
      </div>
      <nav>
        <ul>
          <li class="nav-item active" data-page="workspace" onclick="window.location.href='workspace.html'">
            <button class="nav-btn">Workspace</button>
          </li>
          <li class="nav-item" id="auth-links">
            <button class="nav-btn" onclick="openLogin()">Login</button>
          </li>
          <li class="nav-item" id="user-links" style="display: none;">
            <button class="nav-btn" onclick="logout()">Logout</button>
          </li>
        </ul>
      </nav>
      <div id="user-greeting">
        Hi, <span id="user-name"></span>
      </div>
      <button id="nav-toggle" aria-label="Open navigation">&#9776;</button>
    </div>
  </header>

  <div id="workspace-authorized-content" style="display: none;">
    <div class="main-wrapper">
      <aside class="sidebar">
        <nav class="sidebar-nav">
          <ul>
            <li data-page="previous-designs"><a href="previous_designs.html">Previous Designs</a></li>
            <li class="active" data-page="workspace"><a href="workspace.html">Workspace</a></li>
          </ul>
        </nav>
        <div class="sidebar-user">
          <p>Username: <span id="sidebar-username">Guest</span></p>
          <button class="logout-btn" onclick="logout()">Logout</button>
        </div>
      </aside>

      <main class="main-content-area">
        <!-- Left Column - Input Controls -->
        <div class="workspace-left-column">
          <div class="input-section">
            <h1 class="workspace-title">What do you want to build today?</h1>

            <div class="action-buttons">
              <button class="add-images-btn" id="addImagesBtn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M17 8L12 3L7 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M12 3V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Add Images
              </button>
              <button class="generate-btn" id="generateCodeBtn">Generate</button>
            </div>

            <div class="image-upload-area" id="dropArea" style="display: none;">
              <label for="imageUpload" class="upload-label" id="uploadLabel">
                <svg fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" width="20" height="20">
                  <path d="M10 2a.75.75 0 01.75.75v6.5h6.5a.75.75 0 010 1.5h-6.5v6.5a.75.75 0 01-1.5 0v-6.5h-6.5a.75.75 0 010-1.5h6.5v-6.5A.75.75 0 0110 2z"></path>
                </svg>
                Upload Wireframe Here
              </label>
              <input type="file" id="imageUpload" accept="image/*" style="display: none;">
              <img id="imagePreview" src="#" alt="Image Preview" style="display: none;">
              <p id="fileName"></p>
              <button id="removeImageBtn" class="remove-image-btn" style="display: none;">Remove Image</button>
            </div>

            <p id="statusMessage" class="status-message"></p>
          </div>
        </div>

        <!-- Right Column - Preview/Code Output -->
        <div class="workspace-right-column">
          <div class="output-section">
            <div class="output-tabs">
              <button class="tab-btn active" data-tab="preview">Preview</button>
              <button class="tab-btn" data-tab="code">Code</button>
              <button class="save-zip-btn" id="saveZipBtn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M12 3V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M8 9L12 5L16 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Save ZIP
              </button>
            </div>

            <div class="output-content">
              <!-- Preview Tab Content -->
              <div class="tab-content active" id="preview-tab">
                <iframe id="inspector-preview" sandbox="allow-scripts allow-same-origin"></iframe>
              </div>

              <!-- Code Tab Content -->
              <div class="tab-content" id="code-tab">
                <div class="code-editors">
                  <div class="code-editor-section">
                    <h4>HTML</h4>
                    <textarea id="workspace-html-editor" class="code-editor">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;Page Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;h1&gt;This is a Heading&lt;/h1&gt;
  &lt;p&gt;This is a paragraph.&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</textarea>
                    <button id="saveHtmlBtn2" class="save-btn">Save HTML</button>
                  </div>
                  <div class="code-editor-section">
                    <h4>CSS</h4>
                    <textarea id="workspace-css-editor" class="code-editor">body {
  background: #fff;
  color: #232946;
}
h1 {
  color: #38bdf8;
}</textarea>
                    <button id="saveCssBtn" class="save-btn">Save CSS</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>
  </div>

  <!-- Access denied UI removed -->

  <!-- Modals and footer remain the same as in your original code -->
  <div class="signup-modal" id="signupModal">
    <div class="signup-content">
      <button class="close-btn" onclick="closeSignup()">&times;</button>
      <form id="signupForm" class="signup-form">
        <h2>Join Image2Web</h2>
        <div class="form-group">
          <label for="username">Username</label>
          <input id="signup-username" name="username" type="text" placeholder="Enter your username" required>
        </div>
        <div class="form-group">
          <label for="email">Email</label>
          <input id="signup-email" name="email" type="email" placeholder="Enter your email" required>
        </div>
        <div class="form-group">
          <label for="password">Password</label>
          <input id="signup-password" name="password" type="password" placeholder="Enter your password" required>
        </div>
        <button type="submit" class="signup-btn" style="width: 100%; margin: 0;">
          Create Account
        </button>
        <div class="success-message" id="successMessage" style="display:none;">
          <h3>🎉 Welcome to IMAGE2WEB!</h3>
          <p>Your account has been created successfully.</p>
        </div>
      </form>
    </div>
  </div>

  <div class="login-modal" id="loginModal">
    <div class="login-content">
      <button class="close-btn" onclick="closeLogin()">&times;</button>
      <form class="login-form" id="loginForm">
        <h2 class="login-title">Login to Image2Web</h2>
        <div class="form-group">
          <label for="login-username">Email</label>
          <input type="email" id="login-username" name="login-username" placeholder="Enter your email" required>
        </div>
        <div class="form-group">
          <label for="login-password">Password</label>
          <input type="password" id="login-password" name="login-password" placeholder="Enter your password" required>
        </div>
        <button type="submit" class="login-btn" style="width: 100%; margin: 0;">
          Login
        </button>
      </form>
    </div>
  </div>

  <div class="about-modal" id="aboutModal">
    <div class="about-content">
      <button class="close-btn" onclick="closeAbout()">&times;</button>
      <h2 class="about-title">About Image2Web</h2>
      <p class="about-text">
        Image2Web is a project dedicated to transforming wireframes into beautiful, responsive websites with ease. Our
        mission is to empower developers and designers to bring their ideas to life faster and more efficiently.
      </p>
      <p class="about-text">
        <strong>Team:</strong> Moyano, Sarge Dave M. • Mallari, Merick Joshua • Quiambao, Christian Joshua • Dizon,
        Robby
      </p>
    </div>
  </div>

  <footer>
    <div class="footer-content">
      <div class="footer-section">
        <h3 class="footer-title">About Image2Web</h3>
        <p class="footer-text">
          Image2Web is a tool that helps you turn your wireframes and images into real, responsive websites in seconds.
          Built for developers and designers by SeroTech.
        </p>
        <div class="social-links">
        </div>
      </div>
      <div class="footer-section">
        <h3 class="footer-title">Quick Links</h3>
        <a href="#" class="footer-link" onclick="window.location.href='index.html'">Home</a>
        <a href="#" class="footer-link" onclick="openAbout(); return false;">About</a>
        <a href="#" class="footer-link">Blog</a>
      </div>
      <div class="footer-section">
        <h3 class="footer-title">Contact</h3>
        <p class="footer-text">📧 our email</p>
        <p class="footer-text">📍 A Wireframe to Website Generator</p>
      </div>
    </div>
    <div class="footer-bottom">
      <p class="footer-text">&copy; 2025 Image2Web. All rights reserved. | Crafted with ❤️ for developers</p>
    </div>
  </footer>

  <div id="loading-spinner">
    <div
      style="border:8px solid #eee;border-top:8px solid #0ea5e9;border-radius:50%;width:60px;height:60px;animation:spin 1s linear infinite;">
    </div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-analytics-compat.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script>
    // Firebase initialization and configuration
    const firebaseConfig = {
      apiKey: "AIzaSyDA9TT-iCH515H63y-4zJkTJ1tZAOU7m60",
      authDomain: "image2web-1a6c0.firebaseapp.com",
      projectId: "image2web-1a6c0",
      storageBucket: "image2web-1a6c0.appspot.com",
      messagingSenderId: "167811907825",
      appId: "1:167811907825:web:809c410fefc52de3542950",
      measurementId: "G-LF3Y1S5M47"
    };
    firebase.initializeApp(firebaseConfig);
    firebase.analytics();

    // Helper functions for modals
    function openLogin() {
      document.getElementById('loginModal').classList.add('active');
    }

    function closeLogin() {
      document.getElementById('loginModal').classList.remove('active');
    }

    function openSignup() {
      document.getElementById('signupModal').classList.add('active');
    }

    function closeSignup() {
      document.getElementById('signupModal').classList.remove('active');
    }

    function openAbout() {
      document.getElementById('aboutModal').classList.add('active');
    }

    function closeAbout() {
      document.getElementById('aboutModal').classList.remove('active');
    }

    function logout() {
      firebase.auth().signOut().then(() => {
        console.log("User logged out");
        window.location.href = 'index.html';
      }).catch((error) => {
        console.error("Logout Error:", error);
        alert("Logout failed: " + error.message);
      });
    }

    // Mobile navigation toggle
    document.getElementById('nav-toggle').addEventListener('click', function() {
      const nav = document.querySelector('nav ul');
      nav.classList.toggle('open');
      document.querySelector('.mobile-overlay').classList.toggle('active');
    });

      // Tab switching functionality
      function initTabs() {
        const tabBtns = document.querySelectorAll('.tab-btn');
        const tabContents = document.querySelectorAll('.tab-content');

        tabBtns.forEach(btn => {
          btn.addEventListener('click', () => {
            const targetTab = btn.getAttribute('data-tab');
            
            // Remove active class from all tabs and contents
            tabBtns.forEach(b => b.classList.remove('active'));
            tabContents.forEach(c => c.classList.remove('active'));
            
            // Add active class to clicked tab and corresponding content
            btn.classList.add('active');
            document.getElementById(targetTab + '-tab').classList.add('active');
          });
        });
      }

      // Add Images button functionality
      function initAddImages() {
        const addImagesBtn = document.getElementById('addImagesBtn');
        const imageUploadArea = document.getElementById('dropArea');
        
        addImagesBtn.addEventListener('click', () => {
          imageUploadArea.style.display = imageUploadArea.style.display === 'none' ? 'flex' : 'none';
        });
      }

      // Save ZIP functionality
      function initSaveZip() {
        const saveZipBtn = document.getElementById('saveZipBtn');
        
        saveZipBtn.addEventListener('click', async () => {
          try {
            const htmlContent = document.getElementById('workspace-html-editor').value;
            const cssContent = document.getElementById('workspace-css-editor').value;
            
            if (!htmlContent && !cssContent) {
              alert('No code to save. Please generate some code first.');
              return;
            }

            // Create a new JSZip instance
            const zip = new JSZip();
            
            // Add HTML file
            if (htmlContent) {
              zip.file('index.html', htmlContent);
            }
            
            // Add CSS file
            if (cssContent) {
              zip.file('styles.css', cssContent);
            }
            
            // Add a README file
            const readmeContent = `# Generated Website

This project was generated using Image2Web.

## Files:
- index.html: The main HTML file
- styles.css: The CSS stylesheet

## How to use:
1. Open index.html in your web browser
2. The page will automatically load the styles from styles.css

Generated on: ${new Date().toLocaleString()}
`;
            zip.file('README.md', readmeContent);
            
            // Generate the ZIP file
            const zipBlob = await zip.generateAsync({type: 'blob'});
            
            // Create download link
            const link = document.createElement('a');
            link.href = URL.createObjectURL(zipBlob);
            link.download = `image2web-project-${Date.now()}.zip`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            // Show success message
            const statusMessage = document.getElementById('statusMessage');
            statusMessage.textContent = 'Project saved as ZIP file successfully!';
            statusMessage.style.color = '#10b981';
            
          } catch (error) {
            console.error('Error creating ZIP file:', error);
            const statusMessage = document.getElementById('statusMessage');
            statusMessage.textContent = 'Error saving ZIP file. Please try again.';
            statusMessage.style.color = '#ef4444';
          }
        });
      }

      // Workspace Functionality JavaScript
      document.addEventListener('DOMContentLoaded', function() {
        // Initialize new functionality
        initTabs();
        initAddImages();
        initSaveZip();
      const imageUpload = document.getElementById('imageUpload');
      const imagePreview = document.getElementById('imagePreview');
      const fileNameDisplay = document.getElementById('fileName');
      const generateCodeBtn = document.getElementById('generateCodeBtn');
      const statusMessage = document.getElementById('statusMessage');
      const loadingSpinner = document.getElementById('loading-spinner');
      const workspaceAuthorizedContent = document.getElementById('workspace-authorized-content');
      const body = document.body;

      // Initial state
      workspaceAuthorizedContent.style.display = 'none';
      // access denied UI removed

      // Firebase Authentication Check
      firebase.auth().onAuthStateChanged(user => {
        const authLinks = document.getElementById('auth-links');
        const userLinks = document.getElementById('user-links');
        const userGreeting = document.getElementById('user-greeting');
        const userNameSpan = document.getElementById('user-name');
        const sidebarUsernameSpan = document.getElementById('sidebar-username');

        if (user) {
          // User is signed in
          console.log("User is logged in:", user.email);
          workspaceAuthorizedContent.style.display = 'flex';
          // access denied UI removed

          authLinks.style.display = 'none';
          userLinks.style.display = 'list-item';
          userGreeting.style.display = 'block';
          userNameSpan.textContent = user.displayName || user.email || 'User';
          sidebarUsernameSpan.textContent = user.displayName || user.email || 'User';
        } else {
          // User is logged out
          console.log("User is logged out. Access denied.");
          workspaceAuthorizedContent.style.display = 'none';

          authLinks.style.display = 'list-item';
          userLinks.style.display = 'none';
          userGreeting.style.display = 'none';
          userNameSpan.textContent = '';
          sidebarUsernameSpan.textContent = 'Guest';

          window.location.href = 'index.html';
        }
        body.classList.add('loaded');
      });

      // Image upload functionality
      imageUpload.addEventListener('change', function() {
        if (this.files && this.files[0]) {
          const file = this.files[0];
          const reader = new FileReader();
          reader.onload = function(e) {
            imagePreview.src = e.target.result;
            imagePreview.style.display = 'block';
            fileNameDisplay.textContent = file.name;
            statusMessage.textContent = '';
            
            document.getElementById('uploadLabel').style.display = 'none';
            document.getElementById('removeImageBtn').style.display = 'inline-block';
          };
          reader.readAsDataURL(file);
        }
      });

      // Remove image button
      document.getElementById('removeImageBtn').addEventListener('click', function() {
        imageUpload.value = '';
        imagePreview.src = '#';
        imagePreview.style.display = 'none';
        fileNameDisplay.textContent = '';
        
        document.getElementById('uploadLabel').style.display = 'inline-flex';
        document.getElementById('removeImageBtn').style.display = 'none';
      });

      // Generate code button
      generateCodeBtn.addEventListener('click', async () => {
        if (!imageUpload.files || imageUpload.files.length === 0) {
          statusMessage.textContent = 'Please select an image first.';
          statusMessage.style.color = '#f5576c';
          return;
        }

        // Real API call to backend to generate HTML/CSS
        statusMessage.textContent = 'Processing your image...';
        statusMessage.style.color = '#ffe066';
        loadingSpinner.style.display = 'flex';
        generateCodeBtn.disabled = true;

        try {
          const formData = new FormData();
          formData.append('image', imageUpload.files[0]);
          // include selected theme if you add a selector later; default to espresso
          formData.append('theme', 'espresso');

          // attach a user id if available from Firebase auth
          try {
            const currentUser = firebase.auth().currentUser;
            if (currentUser) formData.append('user_id', currentUser.uid || currentUser.email || 'user');
          } catch (e) {
            // ignore
          }

          // POST to relative API path; change to your deployed URL if needed
          const resp = await fetch('/api/generate', {
            method: 'POST',
            body: formData
          });

          const data = await resp.json();
          if (!resp.ok) {
            throw new Error(data.error || (data.message || 'Generation failed on server'));
          }

          // Populate editors with returned content (will autosize)
          setEditorContents(data.html_content, data.css_content);

          // Save latest generated content to localStorage for viewing on other page
          try {
            if (data.html_content) localStorage.setItem('generated_html', data.html_content);
            if (data.css_content) localStorage.setItem('generated_css', data.css_content);

            // Automatically add this generated result to Previous Designs (projects_list)
            try {
              const raw = localStorage.getItem('projects_list') || '[]';
              const projects = JSON.parse(raw);
              const entry = {
                id: Date.now(),
                title: imageUpload.files && imageUpload.files[0] ? imageUpload.files[0].name : `Generated ${new Date().toLocaleString()}`,
                filename: imageUpload.files && imageUpload.files[0] ? imageUpload.files[0].name : undefined,
                thumbnail: undefined,
                html: data.html_content || '',
                css: data.css_content || '',
                elementCount: data.detected_elements || 0
              };
              // Try to generate a thumbnail snapshot of the generated preview (inspector) so Previous Designs shows the output
              try {
                const htmlContent = document.getElementById('workspace-html-editor').value || '';
                const cssContent = document.getElementById('workspace-css-editor').value || '';
                const maxDim = 300;

                // fallback immediate thumbnail: uploaded imagePreview if present
                const imgEl = document.getElementById('imagePreview');
                if (imgEl && imgEl.src && imgEl.src !== '#' && imgEl.style.display !== 'none') {
                  entry.thumbnail = imgEl.src;
                }

                // Asynchronously create an SVG foreignObject that wraps the generated HTML+CSS and render to canvas
                (function(html, css, entryId) {
                  try {
                    const wrapper = `<div xmlns='http://www.w3.org/1999/xhtml'><style>${css}</style>${html}</div>`;
                    // choose a render width; 900px wide is usually fine and will be scaled down
                    const renderW = 900;
                    const renderH = 600;
                    const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='${renderW}' height='${renderH}'><foreignObject width='100%' height='100%'>${wrapper}</foreignObject></svg>`;
                    const img = new Image();
                    img.onload = function() {
                      try {
                        // scale to maxDim preserving aspect
                        let w = img.width, h = img.height;
                        if (w > h) {
                          if (w > maxDim) { h = Math.round(h * (maxDim / w)); w = maxDim; }
                        } else {
                          if (h > maxDim) { w = Math.round(w * (maxDim / h)); h = maxDim; }
                        }
                        const canvas = document.createElement('canvas');
                        canvas.width = w; canvas.height = h;
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(img, 0, 0, w, h);
                        const small = canvas.toDataURL('image/png');
                        try {
                          const raw2 = localStorage.getItem('projects_list') || '[]';
                          const list2 = JSON.parse(raw2);
                          const idx2 = list2.findIndex(p => String(p.id) === String(entryId));
                          if (idx2 !== -1) {
                            list2[idx2].thumbnail = small;
                            localStorage.setItem('projects_list', JSON.stringify(list2));
                            localStorage.setItem('projects_list_updated_at', String(Date.now()));
                          }
                        } catch (ee) { /* ignore thumbnail replace errors */ }
                      } catch (e) { /* ignore drawing errors */ }
                    };
                    img.onerror = function() { /* ignore errors */ };
                    img.src = 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent(svg);
                  } catch (e) {
                    console.warn('inspector thumbnail generation failed', e);
                  }
                })(htmlContent, cssContent, entry.id);
              } catch (e) { console.warn('thumbnail generation failed', e); }
              projects.unshift(entry);
              // keep list reasonable in size (optional): keep latest 100
              if (projects.length > 100) projects.length = 100;
              localStorage.setItem('projects_list', JSON.stringify(projects));
              // If no thumbnail was produced by the snapshot logic, create a simple SVG placeholder so the card shows something
              try {
                const p0 = projects[0];
                if (!p0.thumbnail) {
                  const title = (p0.title || 'Generated').replace(/"/g, '');
                  const time = new Date(Number(p0.id) || Date.now()).toLocaleString();
                  const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='200' height='140'><rect width='100%' height='100%' fill='#2a0b4a'/><text x='50%' y='45%' fill='#bfe9ff' font-size='14' text-anchor='middle' font-family='Arial, Helvetica, sans-serif'>${title}</text><text x='50%' y='70%' fill='#bfe9ff' font-size='11' text-anchor='middle' font-family='Arial, Helvetica, sans-serif'>${time}</text></svg>`;
                  p0.thumbnail = 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent(svg);
                  localStorage.setItem('projects_list', JSON.stringify(projects));
                }
              } catch (e) { /* ignore placeholder failure */ }
              localStorage.setItem('projects_list_updated_at', String(Date.now()));
              localStorage.setItem('projects_list_last_id', String(entry.id));
            } catch (pe) {
              console.warn('Auto-save to projects_list failed:', pe);
            }
          } catch (e) {
            console.warn('Could not save generated code to localStorage:', e);
          }

          // Update preview
          updateInspectorPreview();

          statusMessage.textContent = `Code generated successfully (${data.detected_elements || 0} elements).`;
          statusMessage.style.color = '#10b981';

          // Attempt to persist project server-side (and client-side fallback)
          try {
            const currentUser = firebase.auth().currentUser;
            if (currentUser) {
              // Get the last saved project ID from localStorage
              const lastId = localStorage.getItem('projects_list_last_id');
              
              // Call backend to save metadata/content
              try {
                const saveResp = await fetch('/api/save_project', {
                  method: 'POST',
                  headers: { 'Content-Type': 'application/json' },
                  body: JSON.stringify({
                    user_id: currentUser.uid,
                    title: imageUpload.files && imageUpload.files[0] ? imageUpload.files[0].name : `Generated ${new Date().toLocaleString()}`,
                    html: data.html_content || '',
                    css: data.css_content || '',
                    html_url: data.html_url || '',
                    css_url: data.css_url || '',
                    elementCount: data.detected_elements || 0,
                    localId: lastId // Include local ID to prevent duplicates
                  })
                });
                const saved = await saveResp.json();
                if (saveResp.ok && saved && saved.success) {
                  // update local metadata so previous_designs shows the server id quickly
                  try {
                    const raw = localStorage.getItem('projects_list') || '[]';
                    const projects = JSON.parse(raw);
                    // find the entry that matches the temp id and replace its id with the real one
                    const idx = projects.findIndex(p => String(p.id) === String(lastId));
                    if (idx !== -1) {
                      projects[idx].id = saved.id;
                      projects[idx].serverId = saved.id; // Mark as synced with server
                      localStorage.setItem('projects_list', JSON.stringify(projects));
                      // If this id was previously marked deleted locally, remove it from deleted list
                      try {
                        const deletedRaw = localStorage.getItem('projects_list_deleted_ids') || '[]';
                        let deletedArr = JSON.parse(deletedRaw);
                        deletedArr = deletedArr.filter(x => String(x) !== String(saved.id));
                        localStorage.setItem('projects_list_deleted_ids', JSON.stringify(deletedArr));
                      } catch (e) { console.warn('failed to clear deleted id after save', e); }
                    }
                  } catch (_) {}
                  localStorage.setItem('projects_list_last_id', String(saved.id));
                } else {
                  console.warn('Server-side project save responded with error', saved);
                }
              } catch (e) {
                console.warn('Server-side save failed, will attempt client-side Firestore save', e);
                // fallback: try client-side Firestore write so the project appears in the user's account immediately
                try {
                  const db = firebase.firestore();
                  const docRef = await db.collection('users').doc(currentUser.uid).collection('projects').add({
                    title: imageUpload.files && imageUpload.files[0] ? imageUpload.files[0].name : `Generated ${new Date().toLocaleString()}`,
                    html: data.html_content || '',
                    css: data.css_content || '',
                    html_url: data.html_url || '',
                    css_url: data.css_url || '',
                    elementCount: data.detected_elements || 0,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    status: 'completed',
                    localId: lastId // Include local ID to prevent duplicates
                  });
                  
                  // Update localStorage with the Firebase document ID
                  try {
                    const raw = localStorage.getItem('projects_list') || '[]';
                    const projects = JSON.parse(raw);
                    const idx = projects.findIndex(p => String(p.id) === String(lastId));
                    if (idx !== -1) {
                      projects[idx].id = docRef.id;
                      projects[idx].serverId = docRef.id;
                      localStorage.setItem('projects_list', JSON.stringify(projects));
                    }
                  } catch (_) {}
                } catch (ee) {
                  console.warn('Client-side Firestore save also failed', ee);
                }
              }
            }
          } catch (saveErr) {
            console.warn('Could not persist project to server/firestore:', saveErr);
          }

          // After generation and persistence attempts, do NOT auto-redirect; user can click View HTML/CSS

        } catch (err) {
          console.error('Generation error:', err);
          statusMessage.textContent = 'Generation failed: ' + (err.message || err);
          statusMessage.style.color = '#f5576c';
        } finally {
          loadingSpinner.style.display = 'none';
          generateCodeBtn.disabled = false;
        }
      });

      // Save HTML and CSS functionality
      document.getElementById('saveHtmlBtn2').onclick = function() {
        const code = document.getElementById('workspace-html-editor').value;
        const blob = new Blob([code], { type: 'text/html' });
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = 'workspace.html';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
      };

      document.getElementById('saveCssBtn').onclick = function() {
        const css = document.getElementById('workspace-css-editor').value;
        const blob = new Blob([css], { type: 'text/css' });
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = 'workspace.css';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
      };

      // Real-time preview update
      function updateInspectorPreview() {
        try {
          const html = document.getElementById('workspace-html-editor').value;
          const css = document.getElementById('workspace-css-editor').value;
          const iframe = document.getElementById('inspector-preview');
          
          if (iframe) {
            const doc = `<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Generated Website Preview</title>
  <style>${css}</style>
</head>
<body>${html}</body>
</html>`;
            
            iframe.srcdoc = doc;
          }
        } catch (error) {
          console.error('Error updating preview:', error);
        }
      }

      document.getElementById('workspace-html-editor').addEventListener('input', updateInspectorPreview);
      document.getElementById('workspace-css-editor').addEventListener('input', updateInspectorPreview);

      // Auto-resize editors so their contents are fully visible (no internal scroll)
      function autosizeTextarea(el) {
        if (!el) return;
        el.style.height = 'auto';
        const newHeight = Math.min(Math.max(el.scrollHeight, 120), 2000);
        el.style.height = newHeight + 'px';
      }

      const htmlEditor = document.getElementById('workspace-html-editor');
      const cssEditor = document.getElementById('workspace-css-editor');
      htmlEditor.addEventListener('input', () => autosizeTextarea(htmlEditor));
      cssEditor.addEventListener('input', () => autosizeTextarea(cssEditor));

      // Ensure editors resize when content is programmatically set
      function setEditorContents(html, css) {
        if (typeof html !== 'undefined' && html !== null) {
          htmlEditor.value = html;
          autosizeTextarea(htmlEditor);
        }
        if (typeof css !== 'undefined' && css !== null) {
          cssEditor.value = css;
          autosizeTextarea(cssEditor);
        }
      }

      // Initial preview and size
      autosizeTextarea(htmlEditor);
      autosizeTextarea(cssEditor);
      updateInspectorPreview();

      // If another page asked us to open a project, load it now
      try {
        const toLoadRaw = localStorage.getItem('image2web_project_to_load');
        if (toLoadRaw) {
          try {
            const payload = JSON.parse(toLoadRaw);
            if (payload && (payload.html || payload.css)) {
              // populate editors and preview
              setEditorContents(payload.html || '', payload.css || '');
              updateInspectorPreview();
              // ensure generated_html/generated_css are set for viewer pages
              try { if (payload.html) localStorage.setItem('generated_html', payload.html); } catch(e){}
              try { if (payload.css) localStorage.setItem('generated_css', payload.css); } catch(e){}
            }
          } catch (e) { console.warn('Failed to parse image2web_project_to_load', e); }
          // remove the stash so it doesn't keep reloading on refresh
          try { localStorage.removeItem('image2web_project_to_load'); } catch (e) {}
        }
      } catch (e) { /* ignore */ }

  // View HTML/CSS button: open generated output viewer (reads generated_html/generated_css from localStorage)
  const viewBtn = document.getElementById('viewGeneratedBtn');
  if (viewBtn) viewBtn.addEventListener('click', () => { window.location.href = 'generated_output.html'; });

  // File export functionality removed
    });
  </script>
</body>

</html>